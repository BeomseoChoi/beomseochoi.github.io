<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> 순환 참조에 대한 걱정 | Beomseo Choi </title> <meta name="author" content="Beomseo Choi"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://beomseochoi.github.io/blog/2025/CircularReference/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Beomseo</span> Choi </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">순환 참조에 대한 걱정</h1> <p class="post-meta"> Created in February 25, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/formatting"> <i class="fa-solid fa-hashtag fa-sm"></i> formatting</a>   <a href="/blog/tag/links"> <i class="fa-solid fa-hashtag fa-sm"></i> links</a>   ·   <a href="/blog/category/develop"> <i class="fa-solid fa-tag fa-sm"></i> Develop</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="순환-참조">순환 참조</h2> <p>프로그래밍하다보면 두 클래스가 서로를 참조하는 일이 발생하는데 이를 순환 참조라고 부른다. 순환 참조는 안티 패턴으로 잘 알려져 있다. A와 B가 서로를 참조한다고 할 때, A를 해제하기 위해 B를 해제해야 하고, B를 해제하기 위해 A를 해제해야 한다. 이러한 문제를 해결하기 위한 방법론을 마련해야 한다.</p> <p>참조 관계는 노드 간 연결로 추상화할 수 있다. A가 B에 의존하면 A→B로 표현할 수 있다. 참조 관계를 노드로 표현하면 하나의 자료구조가 된다. 그 자료구조가 그래프이며, cycle이 존재하면 순환 참조가 발생한다. 참조 관계 그래프에서 Cycle을 제거하면 순환 참조 문제를 근본적으로 해결할 수 있다. 참조 관계가 DAG 자료구조가 되도록 클래스를 디자인해야 순환 참조를 막을 수 있다.</p> <p>근본적인 해결 방법은 알았으나, cycle을 제거하면서 클래스를 디자인하는 게 현실적으로 가능한 작업인가를 고민해야한다. 두 클래스가 통신하는 경우는 매우 빈번하므로 현실적으로 근본적인 해결책은 불가능에 가깝다.</p> <h2 id="소유와-참조">소유와 참조</h2> <p>A와 B가 서로 의존할 때, 서로가 의미하는 ‘의존’이 다를 수 있다. 개념적으로 A는 B를 소유할 수도 있고, 참조할 수도 있다. 두 클래스가 서로의 포인터를 가지기는 하나, 한 클래스는 소유의 의미일 수 있으며, 다른 클래스는 참조의 의미일 수 있다.</p> <p>이 부분에서 용어를 정리할 필요가 있다. 아래 용어는 널리 쓰이는 표현은 아니고 이 포스트에서 사용할 표현이다.</p> <ul> <li>순환 의존 <ul> <li>A와 B가 서로의 포인터를 가지고 있는 상황</li> </ul> </li> <li>순환 소유 <ul> <li>A와 B가 소유 목적으로 순환 의존</li> </ul> </li> <li>순환 참조 <ul> <li>A와 B가 참조 목적으로 순환 의존</li> </ul> </li> </ul> <p>‘널리 알려진’ 순환 참조는 순환 의존을 의미한다.</p> <p>순환 의존은 메모리 해제 이슈를 만든다. 하지만 의존 목적을 생각하면 이 문제를 해결할 수 있다.</p> <ul> <li>A가 B를 소유하고, B는 A를 참조하는 경우 <ul> <li>A가 해제되면서 B를 해제한다.</li> <li>B는 A를 참조하고 있지만, 소유하지 않으므로 단순히 참조를 끊으면 된다.</li> <li>결과적으로, A가 해제되면서 B도 안전하게 해제된다.</li> </ul> </li> </ul> <p>하지만 A와 B가 서로를 소유하는 경우가 문제가 된다.</p> <ul> <li>A를 해제하면 B도 해제해야 하고, B를 해제하면 다시 A를 해제해야 한다.</li> <li>결과적으로 A와 B가 서로를 계속 해제하려는 무한 루프에 빠질 수 있으며, 메모리 이중 해제나 메모리 누수 등의 심각한 문제가 발생할 수 있다.</li> </ul> <p>순환 의존은 현실적으로 막을 수 없는 문제지만 순환 소유만은 막아야 한다. 순환 소유는 A와 B를 소유하는 C를 추가하고, A와 B를 순환 참조로 만들면 된다.</p> <div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">class</span> <span class="nc">A</span><span class="p">;</span>
<span class="k">class</span> <span class="nc">B</span><span class="p">;</span>
<span class="k">class</span> <span class="nc">C</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">A</span>
<span class="p">{</span>
    <span class="n">B</span><span class="o">*</span> <span class="n">b</span><span class="p">;</span> <span class="c1">// 참조</span>
    <span class="n">C</span><span class="o">*</span> <span class="n">c</span><span class="p">;</span> <span class="c1">// 참조</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">B</span>
<span class="p">{</span>
    <span class="n">A</span><span class="o">*</span> <span class="n">a</span><span class="p">;</span> <span class="c1">// 참조</span>
    <span class="n">C</span><span class="o">*</span> <span class="n">c</span><span class="p">;</span> <span class="c1">// 참조</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">C</span>
<span class="p">{</span>
    <span class="n">A</span><span class="o">*</span> <span class="n">a</span><span class="p">;</span> <span class="c1">// 소유</span>
    <span class="n">B</span><span class="o">*</span> <span class="n">b</span><span class="p">;</span> <span class="c1">// 소유</span>
<span class="p">}</span>
</code></pre></div></div> <p>가능한 순환 의존(참조-참조, 소유-참조, 소유-소유)을 지금까지 말한 방법으로 해결할 수 있다. 참조는 관계를 끊고, 소유는 해제하며, 서로 소유하면 Mediator를 추가하여 순환 참조로 만든다.</p> <p>C++은 메모리 해제를 자동으로 관리하기 위한 표준 라이브러리를 제공한다. Shared pointer는 그중 하나이며 reference counting으로 포인터를 관리한다. 그러나 reference counting 또한 순환 의존 문제가 발생한다. Reference count를 가지는 A와 B가 순환 의존하면 서로의 reference count가 1이 되어 둘 다 해제되지 못한다. 그래서 참조 목적 포인터 weak pointer를 제공하여 소유-참조 관계를 만듦으로써 위 문제를 해결할 수 있다.</p> <p>Reference counting에 대한 내용은 해당 포스트의 목적과 맞지 않아 언급하지 않는다. 또한 shared pointer와 weak pointer의 퍼포먼스 이슈도 언급하지 않는다.</p> <h2 id="결론">결론</h2> <p>순환 의존을 없애는 클래스 디자인은 현실적으로 어렵다. 그리고 순환 의존의 세 가지 케이스는 모두 해결 가능하다. 순환 의존을 최대한 없애되 불가피할 경우 소유와 참조 관계를 생각하며 클래스를 디자인해야 한다.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/License/">Open Source Usage Manual</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/WorkingHolidy_3/">Working Holiday (3)</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/bug_report_shallow_copy/">[Bug Report] Shallow copy</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/CES_2024_review/">CES 2024 Review</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/WorkingHolidy_2/">Working Holiday (2)</a> </li> <div id="disqus_thread" style="max-width: 930px; margin: 0 auto;"> <script type="text/javascript">var disqus_shortname="Beomseo Choi",disqus_identifier="/blog/2025/CircularReference",disqus_title="\uc21c\ud658 \ucc38\uc870\uc5d0 \ub300\ud55c \uac71\uc815";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}();</script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by Disqus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Beomseo Choi. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-publications",title:"publications",description:"publications by categories in reversed chronological order. generated by jekyll-scholar.",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-cv",title:"cv",description:"",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"post-open-source-usage-manual",title:"Open Source Usage Manual",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/License/"}},{id:"post-working-holiday-3",title:"Working Holiday (3)",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/WorkingHolidy_3/"}},{id:"post-bug-report-shallow-copy",title:"[Bug Report] Shallow copy",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/bug_report_shallow_copy/"}},{id:"post-\uc21c\ud658-\ucc38\uc870\uc5d0-\ub300\ud55c-\uac71\uc815",title:"\uc21c\ud658 \ucc38\uc870\uc5d0 \ub300\ud55c \uac71\uc815",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/CircularReference/"}},{id:"post-ces-2024-review",title:"CES 2024 Review",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/CES_2024_review/"}},{id:"post-working-holiday-2",title:"Working Holiday (2)",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/WorkingHolidy_2/"}},{id:"post-working-holiday-1",title:"Working Holiday (1)",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/WorkingHolidy_1/"}},{id:"news-lstm-based-time-series-forecasting-of-pulmonary-function-test-for-copd-early-diagnosis-has-been-accepted-in-j-kics",title:"`LSTM-Based Time Series Forecasting of Pulmonary Function Test for COPD Early Diagnosis` has...",description:"",section:"News"},{id:"news-exhibited-at-ces-2024",title:"Exhibited at CES 2024",description:"",section:"News",handler:()=>{window.location.href="/news/Exhibited_at_CES_2024/"}},{id:"projects-project-1",title:"project 1",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/1_project/"}},{id:"projects-project-2",title:"project 2",description:"a project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/2_project/"}},{id:"projects-project-3-with-very-long-name",title:"project 3 with very long name",description:"a project that redirects to another website",section:"Projects",handler:()=>{window.location.href="/projects/3_project/"}},{id:"projects-project-4",title:"project 4",description:"another without an image",section:"Projects",handler:()=>{window.location.href="/projects/4_project/"}},{id:"projects-project-5",title:"project 5",description:"a project with a background image",section:"Projects",handler:()=>{window.location.href="/projects/5_project/"}},{id:"projects-project-6",title:"project 6",description:"a project with no image",section:"Projects",handler:()=>{window.location.href="/projects/6_project/"}},{id:"projects-project-7",title:"project 7",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/7_project/"}},{id:"projects-project-8",title:"project 8",description:"an other project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/8_project/"}},{id:"projects-project-9",title:"project 9",description:"another project with an image \ud83c\udf89",section:"Projects",handler:()=>{window.location.href="/projects/9_project/"}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=qc6CJjYAAAAJ","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("/feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>